#include <iostream>
#include <windows.h>
#include <string>
#include <vector>
#include <queue>
#include <map>
#include <set>
#include <algorithm>
#include <climits>
#include <iomanip>
#include <fstream>
#include <cstdlib> // для rand() та srand()
#include <ctime>   // для time()

using namespace std;

// Структура міста
struct City {
    string name;
    vector<pair<string, int>> neighbors;
};

// Структура квитка
struct Ticket {
    string fullName;
    string phoneNumber;
    string email;
    string departureDate;
    string departureTime;
    vector<string> routePath;
    int totalDistance = 0;
    int ticketNumber = 0;
    double price = 0;
    double travelTimeHours = 0;
};

// База даних міст
map<string, City> cities = {
{ "Київ", { "Київ", {{"Вінниця", {248}}, {"Дніпро", {454}}, {"Донецьк", {754}}, {"Івано-Франківськ", {559}}, {"Херсон", {553}}, {"Хмельницький", {333}}, {"Кропивницький", {303}}, {"Луганськ", {837}}, {"Луцьк", {405}}, {"Львів", {544}}, {"Миколаїв", {488}}, {"Одеса", {477}}, {"Полтава", {350}}, {"Рівне", {331}}, {"Суми", {332}}, {"Тернопіль", {430}}, {"Ужгород", {812}}, {"Харків", {488}}, {"Черкаси", {192}}, {"Чернівці", {552}}, {"Чернігів", {147}}, {"Житомир", {142}}, {"Запоріжжя", {560}} }} },
{ "Вінниця", { "Вінниця", {{"Київ", {248}}, {"Дніпро", {536}}, {"Донецьк", {768}}, {"Івано-Франківськ", {260}}, {"Херсон", {478}}, {"Хмельницький", {115}}, {"Кропивницький", {280}}, {"Луганськ", {795}}, {"Луцьк", {221}}, {"Львів", {269}}, {"Миколаїв", {426}}, {"Одеса", {422}}, {"Полтава", {597}}, {"Рівне", {225}}, {"Суми", {460}}, {"Тернопіль", {190}}, {"Ужгород", {442}}, {"Харків", {601}}, {"Черкаси", {292}}, {"Чернівці", {270}}, {"Чернігів", {336}}, {"Житомир", {120}}, {"Запоріжжя", {567}} }} },
{ "Дніпро", { "Дніпро", {{"Вінниця", {536}}, {"Київ", {454}}, {"Донецьк", {243}}, {"Івано-Франківськ", {690}}, {"Херсон", {312}}, {"Хмельницький", {562}}, {"Кропивницький", {246}}, {"Луганськ", {305}}, {"Луцьк", {697}}, {"Львів", {715}}, {"Миколаїв", {347}}, {"Одеса", {474}}, {"Полтава", {163}}, {"Рівне", {648}}, {"Суми", {328}}, {"Тернопіль", {635}}, {"Ужгород", {861}}, {"Харків", {213}}, {"Черкаси", {330}}, {"Чернівці", {692}}, {"Чернігів", {456}}, {"Житомир", {526}}, {"Запоріжжя", {85}} }} },
{ "Донецьк", { "Донецьк", {{"Вінниця", {748}}, {"Дніпро", {243}}, {"Київ", {754}}, {"Івано-Франківськ", {902}}, {"Херсон", {524}}, {"Хмельницький", {774}}, {"Кропивницький", {458}}, {"Луганськ", {150}}, {"Луцьк", {909}}, {"Львів", {927}}, {"Миколаїв", {559}}, {"Одеса", {686}}, {"Полтава", {409}}, {"Рівне", {860}}, {"Суми", {540}}, {"Тернопіль", {847}}, {"Ужгород", {1073}}, {"Харків", {331}}, {"Черкаси", {542}}, {"Чернівці", {904}}, {"Чернігів", {668}}, {"Житомир", {738}}, {"Запоріжжя", {297}} }} },
{ "Івано-Франківськ", { "Івано-Франківськ", {{"Вінниця", {273}}, {"Дніпро", {753}}, {"Донецьк", {902}}, {"Київ", {559}}, {"Херсон", {752}}, {"Хмельницький", {182}}, {"Кропивницький", {515}}, {"Луганськ", {1038}}, {"Луцьк", {152}}, {"Львів", {136}}, {"Миколаїв", {715}}, {"Одеса", {650}}, {"Полтава", {897}}, {"Рівне", {197}}, {"Суми", {717}}, {"Тернопіль", {136}}, {"Ужгород", {256}}, {"Харків", {881}}, {"Черкаси", {474}}, {"Чернівці", {132}}, {"Чернігів", {608}}, {"Житомир", {394}}, {"Запоріжжя", {807}} }} },
{ "Херсон", { "Херсон", {{"Вінниця", {406}}, {"Дніпро", {337}}, {"Донецьк", {471}}, {"Івано-Франківськ", {752}}, {"Київ", {553}}, {"Хмельницький", {488}}, {"Кропивницький", {310}}, {"Луганськ", {615}}, {"Луцьк", {674}}, {"Львів", {714}}, {"Миколаїв", {63}}, {"Одеса", {145}}, {"Полтава", {491}}, {"Рівне", {620}}, {"Суми", {649}}, {"Тернопіль", {632}}, {"Ужгород", {870}}, {"Харків", {563}}, {"Черкаси", {408}}, {"Чернівці", {707}}, {"Чернігів", {606}}, {"Житомир", {531}}, {"Запоріжжя", {360}} }} },
{ "Хмельницький", { "Хмельницький", {{"Вінниця", {119}}, {"Дніпро", {468}}, {"Донецьк", {701}}, {"Івано-Франківськ", {220}}, {"Херсон", {488}}, {"Київ", {333}}, {"Кропивницький", {366}}, {"Луганськ", {824}}, {"Луцьк", {174}}, {"Львів", {211}}, {"Миколаїв", {536}}, {"Одеса", {426}}, {"Полтава", {671}}, {"Рівне", {164}}, {"Суми", {440}}, {"Тернопіль", {114}}, {"Ужгород", {398}}, {"Харків", {579}}, {"Черкаси", {336}}, {"Чернівці", {192}}, {"Чернігів", {341}}, {"Житомир", {182}}, {"Запоріжжя", {560}} }} },
{ "Кропивницький", { "Кропивницький", {{"Вінниця", {208}}, {"Дніпро", {214}}, {"Донецьк", {446}}, {"Івано-Франківськ", {457}}, {"Херсон", {298}}, {"Хмельницький", {366}}, {"Київ", {303}}, {"Луганськ", {569}}, {"Луцьк", {461}}, {"Львів", {498}}, {"Миколаїв", {202}}, {"Одеса", {246}}, {"Полтава", {249}}, {"Рівне", {407}}, {"Суми", {288}}, {"Тернопіль", {398}}, {"Ужгород", {585}}, {"Харків", {337}}, {"Черкаси", {178}}, {"Чернівці", {466}}, {"Чернігів", {338}}, {"Житомир", {325}}, {"Запоріжжя", {263}} }} },
{ "Луганськ", { "Луганськ", {{"Вінниця", {749}}, {"Дніпро", {287}}, {"Донецьк", {143}}, {"Івано-Франківськ", {982}}, {"Херсон", {610}}, {"Хмельницький", {824}}, {"Кропивницький", {569}}, {"Київ", {837}}, {"Луцьк", {929}}, {"Львів", {966}}, {"Миколаїв", {634}}, {"Одеса", {666}}, {"Полтава", {472}}, {"Рівне", {876}}, {"Суми", {427}}, {"Тернопіль", {915}}, {"Ужгород", {1071}}, {"Харків", {312}}, {"Черкаси", {625}}, {"Чернівці", {942}}, {"Чернігів", {674}}, {"Житомир", {788}}, {"Запоріжжя", {454}} }} },
{ "Луцьк", { "Луцьк", {{"Вінниця", {287}}, {"Дніпро", {612}}, {"Донецьк", {845}}, {"Івано-Франківськ", {211}}, {"Херсон", {669}}, {"Хмельницький", {174}}, {"Кропивницький", {461}}, {"Луганськ", {929}}, {"Київ", {405}}, {"Львів", {150}}, {"Миколаїв", {727}}, {"Одеса", {611}}, {"Полтава", {742}}, {"Рівне", {70}}, {"Суми", {554}}, {"Тернопіль", {161}}, {"Ужгород", {334}}, {"Харків", {690}}, {"Черкаси", {426}}, {"Чернівці", {274}}, {"Чернігів", {402}}, {"Житомир", {243}}, {"Запоріжжя", {704}} }} },
{ "Львів", { "Львів", {{"Вінниця", {370}}, {"Дніпро", {714}}, {"Донецьк", {947}}, {"Івано-Франківськ", {132}}, {"Херсон", {772}}, {"Хмельницький", {211}}, {"Кропивницький", {498}}, {"Луганськ", {966}}, {"Луцьк", {150}}, {"Київ", {544}}, {"Миколаїв", {829}}, {"Одеса", {713}}, {"Полтава", {882}}, {"Рівне", {217}}, {"Суми", {657}}, {"Тернопіль", {121}}, {"Ужгород", {267}}, {"Харків", {793}}, {"Черкаси", {528}}, {"Чернівці", {272}}, {"Чернігів", {544}}, {"Житомир", {425}}, {"Запоріжжя", {806}} }} },
{ "Миколаїв", { "Миколаїв", {{"Вінниця", {415}}, {"Дніпро", {329}}, {"Донецьк", {567}}, {"Івано-Франківськ", {623}}, {"Херсон", {64}}, {"Хмельницький", {493}}, {"Кропивницький", {202}}, {"Луганськ", {634}}, {"Луцьк", {727}}, {"Львів", {829}}, {"Київ", {488}}, {"Одеса", {132}}, {"Полтава", {430}}, {"Рівне", {777}}, {"Суми", {516}}, {"Тернопіль", {703}}, {"Ужгород", {986}}, {"Харків", {529}}, {"Черкаси", {376}}, {"Чернівці", {763}}, {"Чернігів", {583}}, {"Житомир", {539}}, {"Запоріжжя", {291}} }} },
{ "Одеса", { "Одеса", {{"Вінниця", {429}}, {"Дніпро", {474}}, {"Донецьк", {698}}, {"Івано-Франківськ", {623}}, {"Херсон", {183}}, {"Хмельницький", {487}}, {"Кропивницький", {246}}, {"Луганськ", {666}}, {"Луцьк", {611}}, {"Львів", {713}}, {"Миколаїв", {132}}, {"Київ", {477}}, {"Полтава", {562}}, {"Рівне", {661}}, {"Суми", {629}}, {"Тернопіль", {593}}, {"Ужгород", {821}}, {"Харків", {635}}, {"Черкаси", {433}}, {"Чернівці", {616}}, {"Чернігів", {593}}, {"Житомир", {529}}, {"Запоріжжя", {453}} }} },
{ "Полтава", { "Полтава", {{"Вінниця", {597}}, {"Дніпро", {163}}, {"Донецьк", {409}}, {"Івано-Франківськ", {897}}, {"Херсон", {491}}, {"Хмельницький", {671}}, {"Кропивницький", {249}}, {"Луганськ", {472}}, {"Луцьк", {742}}, {"Львів", {882}}, {"Миколаїв", {430}}, {"Одеса", {562}}, {"Київ", {350}}, {"Рівне", {669}}, {"Суми", {176}}, {"Тернопіль", {768}}, {"Ужгород", {1118}}, {"Харків", {143}}, {"Черкаси", {268}}, {"Чернівці", {874}}, {"Чернігів", {405}}, {"Житомир", {480}}, {"Запоріжжя", {278}} }} },
{ "Рівне", { "Рівне", {{"Вінниця", {300}}, {"Дніпро", {574}}, {"Донецьк", {805}}, {"Івано-Франківськ", {229}}, {"Херсон", {690}}, {"Хмельницький", {142}}, {"Кропивницький", {407}}, {"Луганськ", {876}}, {"Луцьк", {70}}, {"Львів", {217}}, {"Миколаїв", {777}}, {"Одеса", {661}}, {"Полтава", {669}}, {"Київ", {331}}, {"Суми", {483}}, {"Тернопіль", {223}}, {"Ужгород", {392}}, {"Харків", {620}}, {"Черкаси", {380}}, {"Чернівці", {341}}, {"Чернігів", {345}}, {"Житомир", {223}}, {"Запоріжжя", {663}} }} },
{ "Суми", { "Суми", {{"Вінниця", {487}}, {"Дніпро", {342}}, {"Донецьк", {450}}, {"Івано-Франківськ", {760}}, {"Херсон", {646}}, {"Хмельницький", {562}}, {"Кропивницький", {288}}, {"Луганськ", {427}}, {"Луцьк", {554}}, {"Львів", {657}}, {"Миколаїв", {516}}, {"Одеса", {629}}, {"Полтава", {176}}, {"Рівне", {483}}, {"Київ", {332}}, {"Тернопіль", {573}}, {"Ужгород", {815}}, {"Харків", {297}}, {"Черкаси", {320}}, {"Чернівці", {680}}, {"Чернігів", {174}}, {"Житомир", {410}}, {"Запоріжжя", {379}} }} },
{ "Тернопіль", { "Тернопіль", {{"Вінниця", {280}}, {"Дніпро", {585}}, {"Донецьк", {818}}, {"Івано-Франківськ", {138}}, {"Херсон", {685}}, {"Хмельницький", {112}}, {"Кропивницький", {398}}, {"Луганськ", {915}}, {"Луцьк", {161}}, {"Львів", {121}}, {"Миколаїв", {703}}, {"Одеса", {593}}, {"Полтава", {768}}, {"Рівне", {223}}, {"Суми", {573}}, {"Київ", {430}}, {"Ужгород", {298}}, {"Харків", {703}}, {"Черкаси", {390}}, {"Чернівці", {146}}, {"Чернігів", {432}}, {"Житомир", {313}}, {"Запоріжжя", {708}} }} },
{ "Ужгород", { "Ужгород", {{"Вінниця", {546}}, {"Дніпро", {870}}, {"Донецьк", {1103}}, {"Івано-Франківськ", {263}}, {"Херсон", {956}}, {"Хмельницький", {440}}, {"Кропивницький", {585}}, {"Луганськ", {1071}}, {"Луцьк", {334}}, {"Львів", {267}}, {"Миколаїв", {986}}, {"Одеса", {821}}, {"Полтава", {1118}}, {"Рівне", {392}}, {"Суми", {815}}, {"Тернопіль", {298}}, {"Київ", {812}}, {"Харків", {923}}, {"Черкаси", {680}}, {"Чернівці", {313}}, {"Чернігів", {799}}, {"Житомир", {680}}, {"Запоріжжя", {907}} }} },
{ "Харків", { "Харків", {{"Вінниця", {556}}, {"Дніпро", {213}}, {"Донецьк", {317}}, {"Івано-Франківськ", {897}}, {"Херсон", {589}}, {"Хмельницький", {634}}, {"Кропивницький", {418}}, {"Луганськ", {305}}, {"Луцьк", {724}}, {"Львів", {829}}, {"Миколаїв", {529}}, {"Одеса", {635}}, {"Полтава", {143}}, {"Рівне", {620}}, {"Суми", {297}}, {"Тернопіль", {703}}, {"Ужгород", {923}}, {"Київ", {488}}, {"Черкаси", {409}}, {"Чернівці", {779}}, {"Чернігів", {414}}, {"Житомир", {553}}, {"Запоріжжя", {297}} }} },
{ "Черкаси", { "Черкаси", {{"Вінниця", {197}}, {"Дніпро", {266}}, {"Донецьк", {495}}, {"Івано-Франківськ", {543}}, {"Херсон", {426}}, {"Хмельницький", {286}}, {"Кропивницький", {117}}, {"Луганськ", {572}}, {"Луцьк", {460}}, {"Львів", {562}}, {"Миколаїв", {376}}, {"Одеса", {433}}, {"Полтава", {268}}, {"Рівне", {380}}, {"Суми", {320}}, {"Тернопіль", {390}}, {"Ужгород", {680}}, {"Харків", {409}}, {"Київ", {192}}, {"Чернівці", {496}}, {"Чернігів", {273}}, {"Житомир", {290}}, {"Запоріжжя", {329}} }} },
{ "Чернівці", { "Чернівці", {{"Вінниця", {329}}, {"Дніпро", {706}}, {"Донецьк", {938}}, {"Івано-Франківськ", {135}}, {"Херсон", {793}}, {"Хмельницький", {220}}, {"Кропивницький", {524}}, {"Луганськ", {1034}}, {"Луцьк", {341}}, {"Львів", {274}}, {"Миколаїв", {763}}, {"Одеса", {616}}, {"Полтава", {874}}, {"Рівне", {341}}, {"Суми", {680}}, {"Тернопіль", {146}}, {"Ужгород", {313}}, {"Харків", {779}}, {"Черкаси", {496}}, {"Київ", {552}}, {"Чернігів", {603}}, {"Житомир", {447}}, {"Запоріжжя", {777}} }} },
{ "Чернігів", { "Чернігів", {{"Вінниця", {350}}, {"Дніпро", {529}}, {"Донецьк", {664}}, {"Івано-Франківськ", {685}}, {"Херсон", {683}}, {"Хмельницький", {428}}, {"Кропивницький", {470}}, {"Луганськ", {731}}, {"Луцьк", {434}}, {"Львів", {545}}, {"Миколаїв", {583}}, {"Одеса", {593}}, {"Полтава", {405}}, {"Рівне", {345}}, {"Суми", {174}}, {"Тернопіль", {432}}, {"Ужгород", {799}}, {"Харків", {414}}, {"Черкаси", {273}}, {"Чернівці", {603}}, {"Київ", {147}}, {"Житомир", {270}}, {"Запоріжжя", {556}} }} },
{ "Запоріжжя", { "Запоріжжя", {{"Вінниця", {465}}, {"Дніпро", {85}}, {"Донецьк", {211}}, {"Івано-Франківськ", {726}}, {"Херсон", {307}}, {"Хмельницький", {553}}, {"Кропивницький", {285}}, {"Луганськ", {318}}, {"Луцьк", {682}}, {"Львів", {786}}, {"Миколаїв", {291}}, {"Одеса", {453}}, {"Полтава", {278}}, {"Рівне", {663}}, {"Суми", {379}}, {"Тернопіль", {708}}, {"Ужгород", {907}}, {"Харків", {297}}, {"Черкаси", {329}}, {"Чернівці", {777}}, {"Чернігів", {556}}, {"Житомир", {549}}, {"Київ", {560}} }} },
{ "Житомир", { "Житомир", {{"Вінниця", {134}}, {"Дніпро", {540}}, {"Донецьк", {764}}, {"Івано-Франківськ", {375}}, {"Херсон", {620}}, {"Хмельницький", {197}}, {"Кропивницький", {371}}, {"Луганськ", {835}}, {"Луцьк", {221}}, {"Львів", {320}}, {"Миколаїв", {539}}, {"Одеса", {529}}, {"Полтава", {480}}, {"Рівне", {223}}, {"Суми", {410}}, {"Тернопіль", {313}}, {"Ужгород", {680}}, {"Харків", {553}}, {"Черкаси", {290}}, {"Чернівці", {447}}, {"Чернігів", {270}}, {"Запоріжжя", {549}}, {"Київ", {142}} }} }
};

// Константи
const double PRICE_PER_KM = 1.5;
const double SPEED = 80.0;

// Функція пошуку найкоротшого шляху
vector<string> dijkstra(const string& start, const string& end, int& totalDistance) {
    map<string, int> dist;
    map<string, string> parent;
    priority_queue<pair<int, string>, vector<pair<int, string>>, greater<pair<int, string>>> pq;
    set<string> visited;

    for (const auto& city : cities) {
        dist[city.first] = INT_MAX;
    }
    dist[start] = 0;
    pq.push({ 0, start });

    while (!pq.empty()) {
        string current = pq.top().second;
        pq.pop();

        if (visited.find(current) != visited.end()) continue;
        visited.insert(current);

        if (current == end) {
            vector<string> path;
            string temp = end;
            while (temp != start) {
                path.push_back(temp);
                temp = parent[temp];
            }
            path.push_back(start);
            reverse(path.begin(), path.end());
            totalDistance = dist[end];
            return path;
        }

        for (const auto& neighbor : cities[current].neighbors) {
            const string& neighborCity = neighbor.first;
            int weight = neighbor.second;
            if (dist[current] + weight < dist[neighborCity]) {
                dist[neighborCity] = dist[current] + weight;
                parent[neighborCity] = current;
                pq.push({ dist[neighborCity], neighborCity });
            }
        }
    }

    return {};
}

// Генерація випадкового номера квитка
int generateTicketNumber() {
    return rand() % 10000 + 1; // від 1 до 10000
}

// Функція інструкції
void showInstructions() {
    cout << "\nІнструкція користування програмою:\n";
    cout << "1. Введіть місто відправлення та місто призначення.\n";
    cout << "2. Заповніть свої дані: ПІБ, телефон, email, дату та час відправлення.\n";
    cout << "3. Програма розрахує маршрут, ціну квитка та час поїздки.\n";
    cout << "4. Ви отримаєте квиток на екран і в файл.\n";
}

// Функція збереження квитка
void saveTicketToFile(const Ticket& ticket) {
    ofstream fout("tickets.txt", ios::app);
    if (!fout) {
        cout << "Помилка відкриття файлу для запису квитка.\n";
        return;
    }

    fout << ticket.ticketNumber << '\n';
    fout << ticket.fullName << '\n';
    fout << ticket.phoneNumber << '\n';
    fout << ticket.email << '\n';
    fout << ticket.departureDate << '\n';
    fout << ticket.departureTime << '\n';

    // Маршрут (з'єднуємо міста стрілочками)
    for (size_t i = 0; i < ticket.routePath.size(); i++) {
        fout << ticket.routePath[i];
        if (i != ticket.routePath.size() - 1)
            fout << " -> ";
    }
    fout << '\n';

    fout << ticket.totalDistance << '\n';
    fout << fixed << setprecision(2) << ticket.travelTimeHours << '\n';
    fout << fixed << setprecision(2) << ticket.price << '\n';
    fout << "=====\n"; // роздільник квитків
    fout.close();
}

// Функція покупки квитка
void buyTicket() {
    string start, end;
    cout << "\nВведіть місто відправлення: ";
    getline(cin >> ws, start);
    cout << "Введіть місто призначення: ";
    getline(cin, end);

    transform(start.begin(), start.end(), start.begin(), ::tolower);
    transform(end.begin(), end.end(), end.begin(), ::tolower);

    if (cities.find(start) == cities.end() || cities.find(end) == cities.end()) {
        cout << "Одне з міст не знайдено у базі даних!\n";
        return;
    }

    int totalDistance = 0;
    vector<string> path = dijkstra(start, end, totalDistance);

    if (path.empty()) {
        cout << "Неможливо знайти шлях між цими містами!\n";
        return;
    }

    Ticket ticket;
    ticket.ticketNumber = generateTicketNumber();
    ticket.routePath = path;
    ticket.totalDistance = totalDistance;
    ticket.price = totalDistance * PRICE_PER_KM;
    ticket.travelTimeHours = totalDistance / SPEED;

    cout << "Введіть Ваше ПІБ: ";
    getline(cin, ticket.fullName);
    cout << "Введіть номер телефону: ";
    getline(cin, ticket.phoneNumber);
    cout << "Введіть email: ";
    getline(cin, ticket.email);
    cout << "Введіть дату відправлення (дд.мм.рррр): ";
    getline(cin, ticket.departureDate);
    cout << "Введіть час відправлення (год:хв): ";
    getline(cin, ticket.departureTime);

    // Вивід квитка
    cout << "\n----- Ваш квиток -----\n";
    cout << "Номер квитка: " << ticket.ticketNumber << endl;
    cout << "ПІБ: " << ticket.fullName << endl;
    cout << "Телефон: " << ticket.phoneNumber << endl;
    cout << "Email: " << ticket.email << endl;
    cout << "Дата відправлення: " << ticket.departureDate << endl;
    cout << "Час відправлення: " << ticket.departureTime << endl;
    cout << "Маршрут: ";
    for (size_t i = 0; i < ticket.routePath.size(); i++) {
        cout << cities[ticket.routePath[i]].name;
        if (i != ticket.routePath.size() - 1) cout << " -> ";
    }
    cout << endl;
    cout << "Відстань: " << ticket.totalDistance << " км\n";
    cout << "Час у дорозі: " << ticket.travelTimeHours << " годин\n";
    cout << "Ціна квитка: " << ticket.price << " грн\n";
    cout << "-----------------------\n";

    saveTicketToFile(ticket);
    cout << "Квиток успішно збережено у файл!\n";
}

// Функція перегляду куплених квитків
void viewPurchasedTickets() {
    ifstream fin("tickets.txt");
    if (!fin.is_open()) {
        cout << "Файл квитків відсутній або ще не створено.\n";
        return;
    }

    cout << "\n===== Ваші куплені квитки =====\n\n";

    string line;
    vector<string> ticketData;
    int ticketNumber = 1;
    bool hasTickets = false;

    while (getline(fin, line)) {
        if (line == "=====") { // роздільник квитків
            if (ticketData.size() == 10) {
                hasTickets = true;
                cout << "Квиток №" << ticketNumber++ << ":\n";
                cout << "Номер квитка: " << ticketData[0] << endl;
                cout << "ПІБ пасажира: " << ticketData[1] << endl;
                cout << "Номер телефону: " << ticketData[2] << endl;
                cout << "Email: " << ticketData[3] << endl;
                cout << "Дата відправлення: " << ticketData[4] << endl;
                cout << "Час відправлення: " << ticketData[5] << endl;
                cout << "Маршрут: " << ticketData[6] << endl;
                cout << "Відстань: " << ticketData[7] << " км" << endl;
                cout << "Час у дорозі: " << ticketData[8] << " годин" << endl;
                cout << "Вартість квитка: " << ticketData[9] << " грн" << endl;
                cout << "-----------------------------\n";
            }
            ticketData.clear();
        }
        else {
            ticketData.push_back(line);
        }
    }

    fin.close();

    if (!hasTickets) {
        cout << "Наразі немає жодного купленого квитка.\n";
    }
}


// Функція видалення квитка за номером
void deleteTicket() {
    ifstream file("tickets.txt");
    if (!file.is_open()) {
        cout << "Немає придбаних квитків!\n";
        return;
    }

    vector<vector<string>> tickets;
    vector<string> currentTicket;
    string line;

    while (getline(file, line)) {
        if (line == "=====") { 
            if (!currentTicket.empty()) {
                tickets.push_back(currentTicket);
                currentTicket.clear();
            }
        }
        else {
            currentTicket.push_back(line);
        }
    }
    file.close();

    if (tickets.empty()) {
        cout << "Немає квитків для видалення!\n";
        return;
    }

    // Показуємо всі квитки
    cout << "\n=== Перелік квитків ===\n\n";
    for (size_t i = 0; i < tickets.size(); ++i) {
        cout << i + 1 << ") ";
        for (const auto& field : tickets[i]) {
            cout << field << " | ";
        }
        cout << "\n";
    }

    int choice;
    cout << "\nВведіть номер квитка, який хочете видалити: ";
    cin >> choice;

    if (choice <= 0 || choice > tickets.size()) {
        cout << "Невірний номер квитка!\n";
        return;
    }

    // Видаляємо квиток
    tickets.erase(tickets.begin() + (choice - 1));

    // Перезаписуємо файл
    ofstream outFile("tickets.txt");
    if (!outFile.is_open()) {
        cout << "Помилка при збереженні файлу!\n";
        return;
    }

    for (const auto& ticket : tickets) {
        for (const auto& field : ticket) {
            outFile << field << endl;
        }
        outFile << "=====" << endl; 
    }
    outFile.close();

    cout << "\nКвиток успішно видалено!\n";
}

// Меню програми
void menu() {
    int option;
    do {
        cout << "\n--- ГОЛОВНЕ МЕНЮ ---\n";
        cout << "1. Інструкція користування\n";
        cout << "2. Купити квиток\n";
        cout << "3. Переглянути придбані квитки\n";
        cout << "4. Видалити квиток\n";
        cout << "5. Вийти\n";
        cout << "Виберіть номер опції: ";
        cin >> option;

        switch (option) {
        case 1:
            showInstructions();
            break;
        case 2:
            buyTicket();
            break;
        case 3:
            viewPurchasedTickets();
            break;
        case 4:
            deleteTicket();
            break;
        case 5:
            cout << "Дякую за використання програми!\n";
            break;
        default:
            cout << "Невірний вибір. Спробуйте ще раз.\n";
        }
    } while (option != 5);
}

int main() {
    SetConsoleCP(1251);
    SetConsoleOutputCP(1251);
    srand(time(0)); // Ініціалізація генератора випадкових чисел

    menu();

    return 0;
}